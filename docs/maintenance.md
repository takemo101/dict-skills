# Maintenance Guide

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€dict-skills ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å®šæœŸçš„ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä½œæ¥­ã«ã¤ã„ã¦èª¬æ˜Žã—ã¾ã™ã€‚

## é–‹ç™ºã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

### è‡ªå‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½¿ç”¨

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯é–‹ç™ºã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

```bash
# ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³ï¼ˆä½•ãŒå‰Šé™¤ã•ã‚Œã‚‹ã‹ç¢ºèªï¼‰
./scripts/cleanup-dev-artifacts.sh

# è©³ç´°ãªå‡ºåŠ›ã‚’è¦‹ã‚‹
./scripts/cleanup-dev-artifacts.sh --verbose

# å®Ÿéš›ã«å‰Šé™¤ã‚’å®Ÿè¡Œï¼ˆ30æ—¥ä»¥ä¸Šå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
./scripts/cleanup-dev-artifacts.sh --force

# ä¿æŒæœŸé–“ã‚’7æ—¥ã«è¨­å®š
./scripts/cleanup-dev-artifacts.sh --days 7 --force
```

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã™ã‚‹ã“ã¨

1. **`.worktrees/` ã®ãƒã‚§ãƒƒã‚¯**
   - å¤ã„ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®æ¤œå‡º
   - ãƒžãƒ¼ã‚¸æ¸ˆã¿ãƒ–ãƒ©ãƒ³ãƒã®ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã‚’ç‰¹å®š
   - æ‰‹å‹•ã§ã®å‰Šé™¤ã‚’ææ¡ˆ

2. **`.improve-logs/` ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—**ï¼ˆé€šå¸¸ã¯ç®¡ç†ä¸è¦ï¼‰
   - pi-runner ãŒç”Ÿæˆã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
   - å­˜åœ¨ã™ã‚‹å ´åˆã¯å¤ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

### æ‰‹å‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

è‡ªå‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã›ãšã«æ‰‹å‹•ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹å ´åˆï¼š

#### .worktrees/ ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

```bash
# ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã‚’ç¢ºèª
git worktree list

# ä¸è¦ã«ãªã£ãŸãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®å‰Šé™¤
git worktree remove .worktrees/issue-XXX-description

# é–¢é€£ã™ã‚‹ãƒ–ãƒ©ãƒ³ãƒã‚‚å‰Šé™¤ï¼ˆãƒžãƒ¼ã‚¸æ¸ˆã¿ã®å ´åˆï¼‰
git branch -d feature/issue-XXX-description

# å¤ã„ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®ãƒ‘ã‚¹ã‚’æ•´ç†
git worktree prune
```

### ãƒžãƒ¼ã‚¸æ¸ˆã¿ãƒ–ãƒ©ãƒ³ãƒã®ç¢ºèª

```bash
# main ã«ãƒžãƒ¼ã‚¸æ¸ˆã¿ã®ãƒ–ãƒ©ãƒ³ãƒã‚’ä¸€è¦§è¡¨ç¤º
git branch --merged main | grep -v main

# ãƒªãƒ¢ãƒ¼ãƒˆã«ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚‚ãƒžãƒ¼ã‚¸æ¸ˆã¿ã®ãƒ–ãƒ©ãƒ³ãƒã‚’å‰Šé™¤
git branch --merged main | grep -v main | xargs git branch -d
```

## å®šæœŸçš„ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æŽ¨å¥¨äº‹é …

### é€±æ¬¡

- [ ] ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã‚’ç¢ºèªã—ã€å®Œäº†ã—ãŸã‚‚ã®ã‚’å‰Šé™¤
- [ ] ãƒžãƒ¼ã‚¸æ¸ˆã¿ãƒ–ãƒ©ãƒ³ãƒã®ç¢ºèª

### æœˆæ¬¡

- [ ] ãƒžãƒ¼ã‚¸æ¸ˆã¿ãƒ–ãƒ©ãƒ³ãƒã®æ•´ç†
- [ ] ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡ã®ç¢ºèª
- [ ] å­¤ç«‹ã—ãŸãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®å‰Šé™¤ã«å¤±æ•—ã™ã‚‹

```bash
# ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®å¼·åˆ¶å‰Šé™¤
git worktree remove --force .worktrees/issue-XXX-description

# ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ãŒå‰Šé™¤ã§ããªã„å ´åˆã¯æ‰‹å‹•ã§
rm -rf .worktrees/issue-XXX-description
git worktree prune
```

### ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ã®ç¢ºèª

```bash
# .worktrees/ ã®ã‚µã‚¤ã‚º
du -sh .worktrees/

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ã‚µã‚¤ã‚º
du -sh .

# Git ãƒªãƒã‚¸ãƒˆãƒªã®ã‚µã‚¤ã‚º
du -sh .git/
```

### å‰Šé™¤ã—ã¦ã¯ã„ã‘ãªã„ã‚‚ã®

ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã¯å‰Šé™¤ã—ãªã„ã§ãã ã•ã„ï¼š

- `.worktrees/.context/` - ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼é–“ã§å…±æœ‰ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±
- `.worktrees/.status/` - ãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ¯ãƒ¼ã‚¯ãƒ„ãƒªãƒ¼ï¼ˆ`git worktree list` ã§è¡¨ç¤ºã•ã‚Œã‚‹ã‚‚ã®ï¼‰

## è‡ªå‹•åŒ–ã®æŽ¨å¥¨

å®šæœŸçš„ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’è‡ªå‹•åŒ–ã™ã‚‹å ´åˆï¼š

### Cron ã‚¸ãƒ§ãƒ–ï¼ˆUnix/Linux/macOSï¼‰

```bash
# crontab ã‚’ç·¨é›†
crontab -e

# æ¯Žé€±æ—¥æ›œæ—¥ã®åˆå‰3æ™‚ã«å®Ÿè¡Œ
0 3 * * 0 cd /path/to/dict-skills && ./scripts/cleanup-dev-artifacts.sh --force --days 30 >> /tmp/dict-skills-cleanup.log 2>&1
```

### Git ãƒ•ãƒƒã‚¯ã®åˆ©ç”¨

```bash
# post-merge ãƒ•ãƒƒã‚¯ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’ææ¡ˆ
cat > .git/hooks/post-merge << 'EOF'
#!/bin/bash
echo "ðŸ’¡ Tip: Run './scripts/cleanup-dev-artifacts.sh' to clean up old development artifacts"
EOF

chmod +x .git/hooks/post-merge
```

## å‚è€ƒãƒªãƒ³ã‚¯

- [Git Worktree Documentation](https://git-scm.com/docs/git-worktree)
- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® .gitignore](../.gitignore)
- [ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](../scripts/cleanup-dev-artifacts.sh)
